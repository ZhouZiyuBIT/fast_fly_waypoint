import matplotlib.pyplot as plt
import matplotlib
matplotlib.rcParams['pdf.fonttype'] = 42
matplotlib.rcParams['ps.fonttype'] = 42
import numpy as np

import sys, os
BASEPATH = os.path.abspath(__file__).split("fast_fly/", 1)[0]+"fast_fly/"
sys.path += [BASEPATH]

ds = np.array([1/1, 1/1.5, 1/2, 1/3, 1/3.5, 1/4, 1/4.5, 1/5, 1/5.5, 1/6, 1/6.5, 1/7, 1/7.5, 1/8, 1/8.5, 1/9, 1/9.5, 1/10])
# opt_t = np.array([11.448014766052545, 11.787239760116519, 11.94449169709534, 12.001143565203918, 12.009366438439377, 12.024716491983977, 12.042188805546745, 12.044477669521575, 12.061446096920848, 12.065915659231877])
# used_t = np.array([[0.09050139188766479, 0.008087538808229579], [0.2618164300918579, 0.05397132655822128], [0.6466596007347107, 0.0972560291615073], [1.2445058226585388, 0.2131515212595687], [1.4218987941741943, 0.2347261118645997], [1.7315568208694458, 0.43539411455102], [1.8991067171096803, 0.20901845092848348], [2.403267741203308, 0.9066604204940346], [2.8310678124427797, 0.9078599775683173], [4.559802675247193, 1.8911455845023564]])

opt_t = np.array([11.614749123258605, 11.716601422234305, 11.76274066405358, 11.806316271181503, 11.81891069022284, 11.827391370866078, 11.83448093093987, 11.840007093309243, 11.844536703833151, 11.848399613526354, 11.851491591961864, 11.854145172247028, 11.856464914213229, 11.85833812925741, 11.860036152490043, 11.861695917323125, 11.863043498416502, 11.864367620569384])
used_t = np.array([[0.2642011499404907, 0.07553534472727334], [0.36749953269958496, 0.08433775692124071], [0.6037717628479004, 0.15951268910209834], [0.9120336294174194, 0.19715465281378522], [1.193879065513611, 0.3807735167787232], [1.2946855020523071, 0.41428502255434774], [1.4996215057373048, 0.4227180013270621], [1.9066688632965088, 0.5446221019487179], [1.9775689935684204, 0.6719516586027309], [2.286847529411316, 0.5442162389360272], [2.40631254196167, 0.5825161917913604], [2.733821530342102, 0.7257379423371905], [3.1381653785705566, 1.205719908511364], [3.5059271955490114, 1.065908324785595], [3.966303939819336, 1.6268881800494246], [4.201880445480347, 0.9782830687058168], [4.4, 1.39048570493386], [5.035792260169983, 1.3253116229526154]])


fig = plt.figure(figsize=(6,3))
ax = fig.add_subplot(111)
ax_t = ax.twinx()

ax.set_ylabel("Solve times [s]")
# ax.set_ylim(0, 7)
ax.plot(1/ds, np.array(used_t)[:,0], linestyle="-", label="Solve time")
ax.fill_between(1/ds, np.array(used_t)[:,0]-np.array(used_t)[:,1], np.array(used_t)[:,0]+np.array(used_t)[:,1], color="skyblue",alpha=0.2)
ax.vlines(4, 0, 7, color="gray", linestyle="--")

ax.set_xlabel("1/D [m]")
ax_t.set_ylabel("Optimal times [s]")
ax_t.set_ylim(11.58, 11.9)
ax_t.plot([],[])
ax_t.plot(1/ds, opt_t, linestyle="--", label="Optimal time")

fig.legend(bbox_to_anchor=(0.0, 1), bbox_transform=ax.transAxes, ncol=1, loc="upper left")
fig.tight_layout(pad=0, rect=[0.01, 0.01, 0.99, 0.95])

plt.savefig(BASEPATH+"figs/time_analysis.eps")
plt.show()